from pathlib import Path
from tqdm import tqdm
from tqdm.contrib.concurrent import thread_map
import os
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("-i", "--idir", str)
parser.add_argument("-o", "--odir", str)
parser.add_argument("-e", "--ext", str, default='.png')
args = parser.parse_args()

paths = list(Path(args.idir).iterdir())
# bad = Path("statout/txt/67ff48a0c3fa2acea6dd1ca1d1e71e49140fcab7dc2ec88516b9a250a3bc1596")
outdir = Path(args.odir)
outpaths = thread_map(lambda p: outdir / (p.name + args.ext), paths)
missing = thread_map(lambda p: not os.path.isfile(p), outpaths)

print(missing.count(1))

with open("rem.txt", "w") as f:
    for i, path in tqdm(enumerate(paths)):
        if missing[i]:
            print(str(path), file=f)
