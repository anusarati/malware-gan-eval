"""Reduce mapped files"""

import pickle
import json
from pathlib import Path
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("-mode", type=str, default="style")
args = parser.parse_args()
if args.mode == "style":
    labels = []
    for path in Path(".").iterdir():
        if "labels" in path.name:
            with open(path, "rb") as f:
                local = pickle.load(f)
                labels += local

    # StyleGAN
    with open("dataset.json", "w") as f:
        json.dump({"labels": labels}, f)
else:
    labels = {}
    for path in Path(".").iterdir():
        if "labels" in path.name:
            with open(path, "rb") as f:
                local = pickle.load(f)
                labels.update(local)
    with open("l_abels.pkl", "w") as f:
        pickle.dump(labels, f)
