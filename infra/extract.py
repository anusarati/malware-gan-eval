import zlib
from pathlib import Path
import sys
from tqdm import tqdm


def decompress_all(dir, out="."):
    dir = Path(dir)
    out = Path(out)
    paths = list(dir.iterdir())
    for path in tqdm(paths):
        stream = open(path, "rb", buffering=0)
        bin = stream.readall()
        decompressed = zlib.decompress(bin)
        outfile = open(out / path.name, "wb")
        outfile.write(decompressed)


if __name__ == "__main__":
    print(*sys.argv[1:])
    decompress_all(*sys.argv[1:])
